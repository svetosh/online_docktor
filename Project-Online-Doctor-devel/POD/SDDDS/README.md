# SDDDS

----
## views.py

#### Вспомогательные функции
`to_pk_set(qs)` - внутренняя функция, преобразует QuerySet в множество первичных ключей.

`sddprocessor(slist)` - функция, обрабатывающая список симптомов (slist) в виде списка строковых значений. Возвращает список докторов в аналогичном формате. Алгоритм:

1. получаем первичные ключи, соответствующие строковым значениям в списке симптомов;
2. собираем два множества классов заболеваний, первое "чисто возможные" и второе "чисто невозможные";
3. вычитаем из первого второе, получая на выходе множество первичных ключей, соответствующих возможным классам заболеваний;
4. проводим аналогичную операцию на множествах специалистов и классов заболеваний;
5. полученное множество специалистов преобразуем в список строковых значений;
6. возвращаем его как результат.

#### "Виды"
Вариант силами Django:

`index` выдаёт страницу, содержащую форму с симптомами (которые разбиты на категории).

`process_symptoms` обрабатывает список симптомов полученный от формы, т.е. выборка специалистов {и запись в БД истории}.

`results` выводит полученный результат.

Кривоватый вариант для JS:
`index_json(request)` отвечает на запросы GET и отдаёт JSON со списками симптомов, разбитых на категории.

`odapi(request)` отвечает на запросы POST, предоставляющие JSON со списком симптомов. Отдаёт список специалистов в виде JSON.

----
## models.py
| Класс   | Поле               | Назначение                                          |
|---------|--------------------|-----------------------------------------------------|
| Category| -                  |                                                     |
|         |category_name       | Имя категории                                       |
| Symptom | -                  |                                                     |
|         |symptom_text        | Описание симптома                                   |
|         |category            | Связь симптом-категория                             |
| Disease | -                  |                                                     |
|         |disease_name        | Имя объекта класса                                  |
|         |allowing_symptoms   | Набор симптомов, позволяющих выбрать объект класса  |
|         |prohibiting_symptoms| Набор симптомов, исключающих выбор объекта класса   |
| Doctor  | -                  |                                                     |
|         |doctor_name         | Имя объекта класса                                  |
|         |allowing_diseases   | Набор заболеваний, позволяющих выбрать объект класса|
|         |prohibiting_diseases| Набор заболеваний, исключающих выбор объекта класса |


